---
// src/pages/observations.astro
import MainLayout from '../layouts/MainLayout.astro';

// Page metadata with optimized image reference
const pageTitle = "Observations & Insights";
const description = "Discover patterns, insights, and key takeaways from our AI tools exploration journey.";
const ogImageUrl = "/images/observations-placeholder.jpg";
---

<MainLayout title={pageTitle} description={description} ogImage={ogImageUrl}>
    <main class="container about-section">
        <div class="about-header">
            <h1>Observations & Insights</h1>
            <p>Discover patterns, insights, and key takeaways from our AI tools exploration journey. Filter by tools, technologies, or concepts to focus on specific areas of interest.</p>
        </div>

        <!-- Mobile tab navigation for small screens -->
        <div class="mobile-tabs">
            <div class="mobile-tab active" data-view="takeaways">Takeaways</div>
            <div class="mobile-tab" data-view="trends">Trends & Patterns</div>
            <div class="mobile-tab" data-view="tools">Tools Comparison</div>
        </div>

        <div class="observations-layout">
            <!-- Left sidebar with filters -->
            <aside class="observations-sidebar">
                <h2>Filter Observations</h2>
                <div class="filter-section">
                    <h3>By Tool/Tech</h3>
                    <div class="filter-options">
                        <label><input type="checkbox" name="filter" value="chatgpt"> ChatGPT</label>
                        <label><input type="checkbox" name="filter" value="claude"> Claude</label>
                        <label><input type="checkbox" name="filter" value="github-copilot"> GitHub Copilot</label>
                        <label><input type="checkbox" name="filter" value="cursor"> Cursor IDE</label>
                        <label><input type="checkbox" name="filter" value="perplexity"> Perplexity</label>
                        <label><input type="checkbox" name="filter" value="gemini"> Gemini</label>
                        <label><input type="checkbox" name="filter" value="llm"> LLMs (General)</label>
                        <!-- Add more tool/tech filters as needed -->
                    </div>
                </div>
                <div class="filter-section">
                    <h3>By Concept</h3>
                    <div class="filter-options">
                        <label><input type="checkbox" name="filter" value="prompting"> Prompting</label>
                        <label><input type="checkbox" name="filter" value="code-gen"> Code Generation</label>
                        <label><input type="checkbox" name="filter" value="debugging"> Debugging</label>
                        <label><input type="checkbox" name="filter" value="context-window"> Context Window</label>
                        <label><input type="checkbox" name="filter" value="usability"> Usability</label>
                        <!-- Add more concept filters as needed -->
                    </div>
                </div>
                 <div class="filter-section view-switch">
                    <h3>View</h3>
                    <div class="filter-options">
                        <label><input type="radio" name="view" value="takeaways" checked> Key Takeaways</label>
                        <label><input type="radio" name="view" value="trends"> Trends & Patterns</label>
                        <label><input type="radio" name="view" value="tools"> Tools Comparison</label>
                    </div>
                </div>
            </aside>

            <!-- Main content area -->
            <section class="observations-content">
                <!-- Content sections will be shown/hidden based on selected view -->

                <!-- Key Takeaways View -->
                <div id="takeaways-view" class="content-view active">
                    <h2>Key Takeaways</h2>
                    <div class="observation-card" data-tags="chatgpt,prompting">
                        <h3>Effective Prompting is Crucial</h3>
                        <p>Getting the most out of models like ChatGPT heavily depends on clear, specific, and iterative prompting. Simple requests yield simple results.</p>
                        <span class="card-date">2025-04-10</span>
                    </div>
                     <div class="observation-card" data-tags="cursor,code-gen,debugging">
                        <h3>Cursor IDE Shines for In-Code Interaction</h3>
                        <p>Cursor's tight integration with the codebase makes AI-assisted refactoring and debugging feel more natural than context-switching to a separate chat interface.</p>
                        <span class="card-date">2025-04-15</span>
                    </div>
                    <!-- Add more takeaway cards -->
                </div>

                <!-- Trends & Patterns View -->
                <div id="trends-view" class="content-view">
                    <h2>Trends & Patterns</h2>
                     <div class="observation-card" data-tags="llm,context-window">
                        <h3>Context Window Limitations</h3>
                        <p>A recurring challenge across multiple LLMs is the limited context window, impacting tasks requiring analysis of large codebases or lengthy conversations.</p>
                        <span class="card-date">2025-04-18</span>
                    </div>
                    <!-- Add more trend cards -->
                </div>

                <!-- Tools Comparison View -->
                <div id="tools-view" class="content-view">
                    <h2>Tools Comparison</h2>
                     <div class="observation-card" data-tags="chatgpt,claude,code-gen">
                        <h3>Code Generation: ChatGPT vs. Claude</h3>
                        <p>Initial tests show Claude often producing more robust or idiomatic code for certain languages, while ChatGPT excels at quick snippets and boilerplate.</p>
                        <span class="card-date">2025-04-20</span>
                    </div>
                    <!-- Add more comparison cards -->
                </div>

            </section>
        </div>
    </main>

    <style>
        /* Core layout styles - optimized for performance */
        .about-section { padding: 2.5rem 0; }
        .about-header { text-align: center; margin-bottom: 2.5rem; }
        .about-header h1 { margin-bottom: 0.625rem; }
        .about-header p { max-width: 50rem; margin: 0 auto 1.25rem; color: #555; line-height: 1.6; }

        /* Layout optimization - reduce calculations with logical properties */
        .observations-layout { display: flex; gap: 1.875rem; margin-block-start: 1.25rem; }
        .observations-sidebar { width: 17.5rem; flex-shrink: 0; border-inline-end: 1px solid #eee; padding-inline-end: 1.25rem; }
        .observations-content { flex-grow: 1; }
        
        /* Filter section styles - flattened selectors for better performance */
        .filter-section { margin-bottom: 1.25rem; }
        .filter-section h3 { margin: 0 0 0.625rem; font-size: 1rem; font-weight: 600; }
        .filter-options { display: flex; flex-direction: column; gap: 0.5rem; }
        .filter-options label { display: flex; align-items: center; gap: 0.5rem; font-size: 0.9rem; cursor: pointer; }

        /* View toggling - use direct properties instead of nesting */
        .content-view { display: none; }
        .content-view.active { display: block; }
        
        /* Card styles - use GPU-accelerated properties */
        .observation-card { background: #f9f9f9; border-radius: 0.5rem; padding: 1rem; margin-bottom: 1.25rem; border: 1px solid #eee; transform: translateZ(0); } /* Hardware acceleration hint */
        .observation-card h3 { margin: 0 0 0.625rem; font-size: 1.2rem; }
        .observation-card p { margin: 0 0 0.625rem; color: #555; line-height: 1.5; }
        .card-date { font-size: 0.85rem; color: #888; display: block; margin-top: 0.625rem; }
        
        /* Add hidden class for JavaScript filtering - better performance than inline styles */
        .hidden { display: none !important; }

        /* Mobile Tabs */
        .mobile-tabs {
            display: none; /* Hidden on larger screens */
            margin-bottom: 20px;
            border-bottom: 1px solid #ccc;
        }
        .mobile-tab {
            display: inline-block;
            padding: 10px 15px;
            cursor: pointer;
            color: #555;
        }
        .mobile-tab.active {
            font-weight: bold;
            border-bottom: 2px solid var(--primary-color);
            color: var(--primary-color);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .observations-layout { flex-direction: column; }
            .observations-sidebar { border-right: none; border-bottom: 1px solid #eee; padding-right: 0; padding-bottom: 20px; margin-bottom: 20px; flex-basis: auto; width: 100%;}
            .filter-section.view-switch { display: none; } /* Hide desktop view switcher */
            .mobile-tabs { display: flex; justify-content: space-around; } /* Show mobile tabs */
        }
    </style>

    <script defer>
        // Observation page functionality - optimized for performance
        document.addEventListener('DOMContentLoaded', () => {
            // Cache DOM selectors for better performance
            const filterInputs = document.querySelectorAll('.observations-sidebar input[name="filter"]');
            const viewRadios = document.querySelectorAll('.observations-sidebar input[name="view"]');
            const mobileTabs = document.querySelectorAll('.mobile-tab');
            const observationCards = document.querySelectorAll('.observation-card');
            const contentViews = document.querySelectorAll('.content-view');
            
            /**
             * Filter observation cards based on selected filters
             */
            function filterCards() {
                // Create array of active filter values
                const activeFilters = Array.from(filterInputs)
                    .filter(input => input.checked)
                    .map(input => input.value);
                    
                // Get current view
                const currentViewValue = document.querySelector('input[name="view"]:checked')?.value + '-view';
                
                // Process all cards at once for better performance
                observationCards.forEach(card => {
                    const cardTags = card.dataset.tags ? card.dataset.tags.split(',') : [];
                    const matchesFilters = activeFilters.length === 0 || 
                                         activeFilters.some(filter => cardTags.includes(filter));
                    const parentView = card.closest('.content-view');
                    const parentViewId = parentView ? parentView.id : null;
                    
                    // Use direct classList manipulation instead of style changes when possible
                    if (matchesFilters && parentViewId === currentViewValue) {
                        card.classList.remove('hidden');
                    } else {
                        card.classList.add('hidden');
                    }
                });
            }
            
            /**
             * Switch between different observation views
             */
            function switchView(viewValue) {
                // Target view ID
                const targetViewId = viewValue + '-view';
                
                // Batch DOM operations for better performance
                contentViews.forEach(view => {
                    view.classList.toggle('active', view.id === targetViewId);
                });
                
                // Update desktop radio state
                const desktopRadio = document.querySelector(`.observations-sidebar input[name="view"][value="${viewValue}"]`);
                if (desktopRadio) desktopRadio.checked = true;
                
                // Update mobile tabs
                mobileTabs.forEach(tab => {
                    tab.classList.toggle('active', tab.dataset.view === viewValue);
                });
                
                // Apply filters to the new view
                filterCards();
            }
            
            // Use event delegation where possible to reduce listeners
            // For filter changes
            filterInputs.forEach(input => {
                input.addEventListener('change', filterCards);
            });
            
            // For view switching
            viewRadios.forEach(radio => {
                radio.addEventListener('change', (e) => switchView(e.target.value));
            });
            
            // For mobile tabs
            document.querySelector('.mobile-tabs')?.addEventListener('click', (e) => {
                if (e.target.classList.contains('mobile-tab')) {
                    switchView(e.target.dataset.view);
                }
            });
            
            // Initial setup - use requestAnimationFrame for smoother rendering
            requestAnimationFrame(() => switchView('takeaways'));
        });
    </script>

</MainLayout>
