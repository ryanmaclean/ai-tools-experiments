{
  "rules": [
    {
      "name": "data-source-consistency",
      "description": "Detect and warn about data duplication across the codebase",
      "pattern": {
        "include": ["src/data/*.js", "src/content/transcripts/*.html"],
        "when": "duplicateDataDetected"
      },
      "action": {
        "suggest": "Data appears to be duplicated between JavaScript data sources and HTML content. Consider consolidating to a single source of truth as outlined in the Strategic Roadmap section 1.2."
      },
      "severity": "warning"
    },
    {
      "name": "visual-test-outdated",
      "description": "Detect when visual test screenshots are outdated",
      "pattern": {
        "include": ["tests/validation-screenshots/*.png"],
        "when": "modifiedAfter:30d"
      },
      "action": {
        "suggest": "Visual test screenshots haven't been updated in over 30 days. Consider capturing new screenshots as outlined in Strategic Roadmap section 1.1."
      },
      "severity": "warning"
    },
    {
      "name": "docker-test-environment",
      "description": "Ensure Docker test environments are properly configured",
      "pattern": {
        "include": ["docker-compose-test.yml", "Dockerfile.test"],
        "when": "fileChanged"
      },
      "action": {
        "suggest": "Changes to Docker test environment detected. Ensure all dependencies are properly included for consistent testing (Node.js, ImageMagick, etc.) as per Strategic Roadmap section 1.3."
      },
      "severity": "info"
    },
    {
      "name": "resource-extraction-todo",
      "description": "Remind about the TODO to extract resources from HTML to JS",
      "pattern": {
        "include": ["src/data/resources.js"],
        "match": "// TODO: Add the rest of the resource objects"
      },
      "action": {
        "suggest": "This TODO item is part of the Data Source Consolidation objective (Strategic Roadmap 1.2). Complete the extraction of resource data from HTML to JavaScript to establish a single source of truth."
      },
      "severity": "info"
    },
    {
      "name": "optimize-images",
      "description": "Detect unoptimized images and suggest optimization",
      "pattern": {
        "include": ["public/images/**/*.{png,jpg,jpeg}"],
        "exclude": ["public/images/**/*.{webp,avif}"],
        "when": "fileSize>200KB"
      },
      "action": {
        "suggest": "Large image file detected. Consider optimizing and converting to WebP/AVIF as outlined in Strategic Roadmap section 3.1."
      },
      "severity": "info"
    },
    {
      "name": "astro-5-features",
      "description": "Suggest Astro 5.0+ View Transitions implementation",
      "pattern": {
        "include": ["src/layouts/MainLayout.astro"],
        "notContains": "<ViewTransitions"
      },
      "action": {
        "suggest": "MainLayout.astro could benefit from Astro 5.0+'s View Transitions API for smooth page navigation as outlined in Strategic Roadmap section 4.1."
      },
      "severity": "info"
    },
    {
      "name": "datadog-integration",
      "description": "Ensure Datadog RUM integration is properly set up",
      "pattern": {
        "include": ["src/js/datadog-rum.js", "scripts/inject-datadog-tokens.js"],
        "when": "fileChanged"
      },
      "action": {
        "suggest": "Changes to Datadog integration detected. Ensure proper monitoring is configured as outlined in Strategic Roadmap section 2.1 and 2.2."
      },
      "severity": "info"
    },
    {
      "name": "terraform-validation",
      "description": "Validate Terraform files for Datadog synthetics",
      "pattern": {
        "include": ["terraform/*.tf"],
        "when": "fileChanged"
      },
      "action": {
        "suggest": "Changes to Terraform configuration detected. Run validation with './terraform/validate-terraform.sh' to ensure proper syntax and functionality."
      },
      "severity": "warning"
    },
    {
      "name": "content-collections-migration",
      "description": "Suggest migrating HTML content to Astro Content Collections",
      "pattern": {
        "include": ["src/content/transcripts/*.html"],
        "when": "fileAdded"
      },
      "action": {
        "suggest": "New HTML transcript added. Consider migrating to Astro Content Collections for improved type safety and management as outlined in Strategic Roadmap section 4.2."
      },
      "severity": "info"
    },
    {
      "name": "image-system-update",
      "description": "Suggest using Astro's Image component",
      "pattern": {
        "include": ["src/**/*.astro"],
        "match": "<img src="
      },
      "action": {
        "suggest": "Consider replacing <img> tags with Astro's <Image /> component for improved performance and optimization as outlined in Strategic Roadmap section 4.3."
      },
      "severity": "info"
    }
  ],
  "mcp_server_suggestions": [
    {
      "name": "datadog-monitor",
      "description": "A Datadog MCP server to integrate with the Datadog API",
      "tools": [
        {
          "name": "get_synthetics_results",
          "description": "Retrieve results from Datadog synthetic tests"
        },
        {
          "name": "create_synthetic_test",
          "description": "Create a new synthetic test in Datadog"
        },
        {
          "name": "update_rum_config",
          "description": "Update Real User Monitoring configuration"
        }
      ],
      "resources": [
        {
          "uri": "datadog/synthetics/results",
          "description": "Latest synthetic test results from Datadog"
        },
        {
          "uri": "datadog/rum/metrics",
          "description": "Real User Monitoring metrics"
        }
      ]
    },
    {
      "name": "image-optimizer",
      "description": "An MCP server for optimizing and converting images",
      "tools": [
        {
          "name": "optimize_image",
          "description": "Optimize an image file to reduce size while maintaining quality"
        },
        {
          "name": "convert_to_webp",
          "description": "Convert image to WebP format"
        },
        {
          "name": "convert_to_avif",
          "description": "Convert image to AVIF format"
        },
        {
          "name": "analyze_image_size",
          "description": "Analyze an image and suggest optimal dimensions"
        }
      ],
      "resources": [
        {
          "uri": "optimization/stats",
          "description": "Statistics on image optimization"
        }
      ]
    },
    {
      "name": "ollama-visual-analyzer",
      "description": "An MCP server to integrate with Ollama for visual analysis",
      "tools": [
        {
          "name": "compare_screenshots",
          "description": "Compare two screenshots and highlight differences"
        },
        {
          "name": "analyze_ui_elements",
          "description": "Identify and analyze UI elements in a screenshot"
        },
        {
          "name": "generate_visual_report",
          "description": "Generate a visual comparison report"
        }
      ],
      "resources": [
        {
          "uri": "ollama/models",
          "description": "Available Ollama models for visual analysis"
        },
        {
          "uri": "ollama/comparison/history",
          "description": "History of visual comparisons"
        }
      ]
    },
    {
      "name": "astro-content-manager",
      "description": "An MCP server to help manage and migrate Astro content",
      "tools": [
        {
          "name": "html_to_collection",
          "description": "Convert HTML content to Astro Content Collection format"
        },
        {
          "name": "generate_schema",
          "description": "Generate schema for Content Collection based on content"
        },
        {
          "name": "validate_content",
          "description": "Validate content against schema"
        }
      ],
      "resources": [
        {
          "uri": "astro/content/stats",
          "description": "Statistics on content collections"
        }
      ]
    },
    {
      "name": "performance-analyzer",
      "description": "An MCP server to analyze website performance",
      "tools": [
        {
          "name": "analyze_core_web_vitals",
          "description": "Analyze Core Web Vitals metrics"
        },
        {
          "name": "optimize_js_bundle",
          "description": "Suggest optimizations for JavaScript bundles"
        },
        {
          "name": "analyze_network_payload",
          "description": "Analyze network payload size and suggest reductions"
        }
      ],
      "resources": [
        {
          "uri": "performance/history",
          "description": "Historical performance metrics"
        },
        {
          "uri": "performance/recommendations",
          "description": "Performance optimization recommendations"
        }
      ]
    }
  ]
}
